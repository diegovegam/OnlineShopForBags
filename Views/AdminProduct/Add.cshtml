@model OnlineShopForBags.Models.ViewModels.ProductViewModel


@{
}

<div class="container py-5">
	<form method="post">
		<div class="mb-3">
			<label class="form-label">Nombre</label>
			<input type="text" class="form-control" id="name" asp-for="Name" required></input>
			<span class="text-danger" asp-validation-for="Name"></span>
		</div>
		<div class="mb-3">
			<label class="form-label">Precio</label>
			<input type="number" class="form-control" id="price" asp-for="Price" required></input>
			<span class="text-danger" asp-validation-for="Price"></span>
		</div>
		<div class="mb-3">
			<label class="form-label">Cantidad</label>
			<input type="number" class="form-control" id="quantity" asp-for="Quantity" required></input>
			<span class="text-danger" asp-validation-for="Quantity"></span>
		</div>
		<div class="mb-3">
			<label class="form-label">Código</label>
			<input type="number" class="form-control" id="code" asp-for="Code" required></input>
			<span class="text-danger" asp-validation-for="Code"></span>
		</div>
		<div class="mb-3">
			<label class="form-label">Descripción del producto</label>
			<input type="text" class="form-control" id="description" asp-for="Description"></input>
		</div>
		<div class="mb-3">
			<label class="form-label">Subir Imagen</label>
			<input type="file" id="ImageUpload" class="form-control"></input>

			<img src="" class="mt-3" id="ImageDisplay" style="display:none;width: 300px" />
		</div>

		<div class="mb-3">
			<label class="form-label">URL de la imagen</label>
			<input type="text" class="form-control" id="ImageURL" asp-for="ImageUrl"></input>
		</div>


		<div class="mb-3">
			<button type="submit" class="btn btn-outline-dark">Guardar</button>
		</div>

	</form>
</div>

@section Scripts
{
	<script>
		const ImageUploadInput = document.getElementById('ImageUpload');
		const ImageUrl = document.getElementById('ImageURL');
		const ImageDisplay = document.getElementById('ImageDisplay');

		async function UploadImage(e)
		{
			console.log(e.target.files[0]);
			let data = new FormData();
			data.append('image', e.target.files[0])
			await fetch('/api/images', {
				method: 'POST',
				headers: {
					'Accept': '*/*'
				},
				body: data
			}).then(response => response.json())
				.then(result => {
					ImageUrl.value = result.link;
					ImageDisplay.src = result.link;
					ImageDisplay.style.display = 'block';
					ImageDisplay.classList.add('disabled');
				});
		}


		ImageUploadInput.addEventListener('change', UploadImage);




	</script>

}